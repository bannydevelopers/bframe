<?php if(isset($msg)){?>
<p class="msg content rounded box-shadow" onclick="this.parentNode.removeChild(this)"><?=$msg?></p>
<?php }?>
<h1 class="flex">
    <span>Sylabus</span>
    <button class="flex-shrink round" onclick="add_sylabus()">ADD SYLABUS</button>
</h1>
<div class="white">
    <div class="flex cards">
        <?php foreach($sylabus as $cl){?>
        <div class="rounded">
            <div class="content grey">
                <strong><?=$cl['sylabus_title']?></strong>
            </div>
            
            <div class="content-small">
                <div class="content-small">
                    <strong>Subject:</strong>&nbsp; <?=$cl['subject_name']?>
                </div>
                <div class="content-small">
                    <strong>Class:</strong>&nbsp; <?=$cl['class_name']?>
                </div>
                <div style="text-align: right;border-top: 1px solid #eee;">
                    <a class="content-small" onclick="view_sylabus(`<?=$cl['sylabus_title']?>`)" data-icon="&#xf06e;"></a>
                    <a class="content-small" onclick="delete_sylabus(`<?=$cl['sylabus_id']?>`)" data-icon="&#xf2ed;"></a>
                </div>
                <div style="display: none;"><?=$cl['sylabus_content']?></div>
            </div>
        </div>
        <?php }?>
    </div>
</div>
<template>
    <?php include __DIR__.'/sylabus_add.html';?>
</template>
<style>
    .wideSwal{
        min-width: 80%;
    }
    .wideSwal label{
        text-align: left;
        display: block;
    }
    .wideSwal .flex > *{
        flex-basis: 100%;
    }
</style>
<script>
    var tinymce_toolbar = 'save | undo redo | bold italic underline strikethrough | fontselect | fontsizeselect '
                            +'| formatselect | alignleft aligncenter alignright alignjustify | outdent indent '
                            +'|  numlist bullist table | image media link | ltr rtl '
                            +'| charmap emoticons fullscreen code';
    const add_sylabus = ()=>{
        let htf = document.querySelector('template').content.cloneNode(true).children[0];
        Swal.fire({
            title: 'Add sylabus',
            html:htf,
            customClass:'wideSwal',
            showConfirmButton:false
        });
        setTimeout(()=>{
            tinymce.init({selector: 'textarea.tinymce', menubar: '', plugins: "code", toolbar:tinymce_toolbar});
        },300);
        
        document.querySelector('.wideSwal [type=reset]').addEventListener('click', evt=>{Swal.close()});
    };
    const view_sylabus = stitle=>{
        let sbody = window.event.target.parentNode.nextElementSibling.innerHTML;
        Swal.fire(
            {
                title: stitle,
                html: sbody,
                customClass: 'wideSwal'
            }
        );
    }
</script>