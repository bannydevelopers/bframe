<div class="flex">
    <h1 class="content-small no-pad-top">Staff</h1>
    <div class="shrink">
        <button onclick="add_form('staff')" value="add" data-form-width="wide">Register staff</button>
    </div>
</div>
<br>
<div>
    <table>
        <thead>
            <tr>
                <th>
                    <input type="checkbox" onclick="upadte_checks()">
                </th>
                <th>
                    Particulars
                </th>
                <th>
                    Contacts
                </th>
                <th>
                    Role/Designation
                </th>
                <th>
                    Department
                </th>
                <th>
                    &nbsp;
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <input type="checkbox" onclick="upadte_checks()">
                </td>
                <td class="flex" style="display: flex;">
                    <img src="<?=user::init()->get_user_avatar()?>" width="20">
                    <span>&nbsp;Juma Sonyo</span>
                </td>
                <td>
                    04533455<br>
                    test@loca.hs
                </td>
                <td>
                    <b>Teacher</b><br>
                    <em>Head teacher</em>
                </td>
                <td>
                    Science
                </td>
                <td>
                    <button>Delete</button>
                </td>
            </tr>
            <tr>
                <td>
                    <input type="checkbox" onclick="upadte_checks()">
                </td>
                <td class="flex" style="display: flex;">
                    <img src="<?=user::init()->get_user_avatar()?>" width="20">
                    <span>
                        <b>&nbsp;Juma Sonyo</b><br>
                        <em>&nbsp;Headquarters</em>
                    </span>
                </td>
                <td>
                    04533455<br>
                    test@loca.hs
                </td>
                <td>
                    <b>Teacher</b><br>
                    <em>Head teacher</em>
                </td>
                <td>
                    Science
                </td>
                <td>
                    <button>Delete</button>
                </td>
            </tr>
            <tr>
                <td>
                    <input type="checkbox" onclick="upadte_checks()">
                </td>
                <td class="flex" style="display: flex;">
                    <img src="<?=user::init()->get_user_avatar()?>" width="20">
                    <span>&nbsp;Juma Sonyo</span>
                </td>
                <td>
                    04533455<br>
                    test@loca.hs
                </td>
                <td>
                    <b>Teacher</b><br>
                    <em>Head teacher</em>
                </td>
                <td>
                    Science
                </td>
                <td>
                    <button>Delete</button>
                </td>
            </tr>
            <tr>
                <td>
                    <input type="checkbox" onclick="upadte_checks()">
                </td>
                <td class="flex" style="display: flex;">
                    <img src="<?=user::init()->get_user_avatar()?>" width="20">
                    <span>&nbsp;Juma Sonyo</span>
                </td>
                <td>
                    04533455<br>
                    test@loca.hs
                </td>
                <td>
                    <b>Teacher</b><br>
                    <em>Head teacher</em>
                </td>
                <td>
                    Science
                </td>
                <td>
                    <button>Delete</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<script>
    function add_form(name){
        let main_evt = window.event;
        main_evt.preventDefault();
        if(main_evt.target.value == 'add'){
            let wide = main_evt.target.getAttribute('data-form-width');
            let customClass = (wide == 'wide') ? 'mySwalForm' : 'mySwalSmallForm';
            request_service(
                `add_${name}`,
                response => {
                    if(response != ''){
                        Swal.fire({
                            html:response,
                            showConfirmButton:false,
                            customClass: customClass
                        });
                    }
                    else{
                        Swal.fire({
                            html:'Service not available',
                            icon:'info'
                        });
                    }
                    let form = document.querySelector(`.${customClass} form`);
                    if(form != null){
                        form.addEventListener(
                            'submit',
                            evt=>{
                                evt.preventDefault();
                                let fd = new FormData(form);
                                request_service(
                                    `add_${name}`,
                                    response => {
                                        res_json = JSON.parse(response);
                                        if(res_json){
                                            Swal.fire({
                                                title:res_json.message,
                                                icon: res_json.status
                                            });
                                        }
                                        else {
                                            Swal.fire({
                                                title: 'Malformed response returned',
                                                icon: 'error'
                                            });
                                        }
                                    },
                                    fd
                                );
                            }
                        );
                    }
                }
            );
        }
        else return true;
    }
</script>
<style>
    .mySwalForm{
        min-width: 80%;
    }
    .mySwalForm label, .mySwalSmallForm label{
        display: block;
        text-align: left;
        padding-left: 1em;
    }
    .mySwalSmallForm label{
        padding-left: 0;
    }
</style>
<style>
    .contentx{
        padding: 0 1em;
        flex-basis: 100%;
    }
    .contentx > *{
        flex-basis: 100%;
    }
    .contentx input,.contentx select{
        border:1px solid #eee;
        width: calc( 100% - 1.8em );
        margin-top: 6px;
    }
    .contentx label{
        padding-top: .8em;
    }
    .contentx option{
        line-height: 1.5em;
    }
    button{
        text-transform: uppercase;
    }
</style>